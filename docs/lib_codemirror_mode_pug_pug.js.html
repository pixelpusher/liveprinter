<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>lib/codemirror/mode/pug/pug.js - LivePrinter</title>
    
    <meta name="description" content="Livecoding for 3D printers and other CNC machines" />
    
        <meta name="keywords" content="livecoding,3d printing, cnc,javascript" />
        <meta name="keyword" content="livecoding,3d printing, cnc,javascript" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/pixelpusher/liveprinter" target="_blank" class="menu-item" id="website_link" >LivePrinter main website</a></h2><h2><a href="https://talk.lurk.org/channel/liveprinter" target="_blank" class="menu-item" id="forum_link" >Forum</a></h2><h3>Namespaces</h3><ul><li><a href="LivePrinter.html">LivePrinter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LivePrinter.html#.appendLoggingNode">appendLoggingNode</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.blinkElem">blinkElem</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.codeToJSON">codeToJSON</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.doError">doError</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.getSerialPorts">getSerialPorts</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.globalEval">globalEval</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.queueGCode">queueGCode</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.runCode">runCode</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.scope.mousemove">scope.mousemove</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.sendGCode">sendGCode</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.setLanguageMode">setLanguageMode</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.storageAvailable">storageAvailable</a></li><li data-type='method' style='display: none;'><a href="LivePrinter.html#.updateTemperature">updateTemperature</a></li></ul></li><li><a href="LivePrinter.CodeMirror.html">CodeMirror</a></li></ul><h3>Classes</h3><ul><li><a href="CSSLint.html">CSSLint</a></li><li><a href="LivePrinter-window.scope.Scheduler.html">Scheduler</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LivePrinter-window.scope.Scheduler.html#.clearEvents">clearEvents</a></li><li data-type='method' style='display: none;'><a href="LivePrinter-window.scope.Scheduler.html#.removeEvent">removeEvent</a></li><li data-type='method' style='display: none;'><a href="LivePrinter-window.scope.Scheduler.html#.removeEventByName">removeEventByName</a></li><li data-type='method' style='display: none;'><a href="LivePrinter-window.scope.Scheduler.html#.scheduleEvent">scheduleEvent</a></li><li data-type='method' style='display: none;'><a href="LivePrinter-window.scope.Scheduler.html#.startScheduler">startScheduler</a></li></ul></li><li><a href="parserlib.css.html">css</a></li><li><a href="parserlib.util.html">util</a></li><li><a href="Printer.html">Printer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Printer.html#_extrude">_extrude</a></li><li data-type='method' style='display: none;'><a href="Printer.html#angle">angle</a></li><li data-type='method' style='display: none;'><a href="Printer.html#circle">circle</a></li><li data-type='method' style='display: none;'><a href="Printer.html#clipToPrinterBounds">clipToPrinterBounds</a></li><li data-type='method' style='display: none;'><a href="Printer.html#d2r">d2r</a></li><li data-type='method' style='display: none;'><a href="Printer.html#dist">dist</a></li><li data-type='method' style='display: none;'><a href="Printer.html#distance">distance</a></li><li data-type='method' style='display: none;'><a href="Printer.html#elev">elev</a></li><li data-type='method' style='display: none;'><a href="Printer.html#elevation">elevation</a></li><li data-type='method' style='display: none;'><a href="Printer.html#extrude">extrude</a></li><li data-type='method' style='display: none;'><a href="Printer.html#extrudeto">extrudeto</a></li><li data-type='method' style='display: none;'><a href="Printer.html#fan">fan</a></li><li data-type='method' style='display: none;'><a href="Printer.html#fill">fill</a></li><li data-type='method' style='display: none;'><a href="Printer.html#fillDirection">fillDirection</a></li><li data-type='method' style='display: none;'><a href="Printer.html#fwretract">fwretract</a></li><li data-type='method' style='display: none;'><a href="Printer.html#go">go</a></li><li data-type='method' style='display: none;'><a href="Printer.html#lh">lh</a></li><li data-type='method' style='display: none;'><a href="Printer.html#m2s">m2s</a></li><li data-type='method' style='display: none;'><a href="Printer.html#midi2speed">midi2speed</a></li><li data-type='method' style='display: none;'><a href="Printer.html#move">move</a></li><li data-type='method' style='display: none;'><a href="Printer.html#moveto">moveto</a></li><li data-type='method' style='display: none;'><a href="Printer.html#note">note</a></li><li data-type='method' style='display: none;'><a href="Printer.html#pause">pause</a></li><li data-type='method' style='display: none;'><a href="Printer.html#printPaths">printPaths</a></li><li data-type='method' style='display: none;'><a href="Printer.html#r2d">r2d</a></li><li data-type='method' style='display: none;'><a href="Printer.html#rect">rect</a></li><li data-type='method' style='display: none;'><a href="Printer.html#resume">resume</a></li><li data-type='method' style='display: none;'><a href="Printer.html#retract">retract</a></li><li data-type='method' style='display: none;'><a href="Printer.html#run">run</a></li><li data-type='method' style='display: none;'><a href="Printer.html#sendExtrusionGCode">sendExtrusionGCode</a></li><li data-type='method' style='display: none;'><a href="Printer.html#sendFirmwareRetractSettings">sendFirmwareRetractSettings</a></li><li data-type='method' style='display: none;'><a href="Printer.html#sendQueued">sendQueued</a></li><li data-type='method' style='display: none;'><a href="Printer.html#speed">speed</a></li><li data-type='method' style='display: none;'><a href="Printer.html#speedScale">speedScale</a></li><li data-type='method' style='display: none;'><a href="Printer.html#start">start</a></li><li data-type='method' style='display: none;'><a href="Printer.html#temp">temp</a></li><li data-type='method' style='display: none;'><a href="Printer.html#thick">thick</a></li><li data-type='method' style='display: none;'><a href="Printer.html#turn">turn</a></li><li data-type='method' style='display: none;'><a href="Printer.html#unretract">unretract</a></li><li data-type='method' style='display: none;'><a href="Printer.html#up">up</a></li><li data-type='method' style='display: none;'><a href="Printer.html#wait">wait</a></li></ul></li><li><a href="Vector.html">Vector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Vector.html#.add">add</a></li><li data-type='method' style='display: none;'><a href="Vector.html#.div">div</a></li><li data-type='method' style='display: none;'><a href="Vector.html#.mult">mult</a></li><li data-type='method' style='display: none;'><a href="Vector.html#.sub">sub</a></li><li data-type='method' style='display: none;'><a href="Vector.html#addSelf">addSelf</a></li><li data-type='method' style='display: none;'><a href="Vector.html#dist">dist</a></li><li data-type='method' style='display: none;'><a href="Vector.html#divSelf">divSelf</a></li><li data-type='method' style='display: none;'><a href="Vector.html#mag">mag</a></li><li data-type='method' style='display: none;'><a href="Vector.html#magSq">magSq</a></li><li data-type='method' style='display: none;'><a href="Vector.html#multSelf">multSelf</a></li><li data-type='method' style='display: none;'><a href="Vector.html#set">set</a></li><li data-type='method' style='display: none;'><a href="Vector.html#subSelf">subSelf</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#addFormatter">addFormatter</a></li><li><a href="global.html#addListener">addListener</a></li><li><a href="global.html#addRule">addRule</a></li><li><a href="global.html#advance">advance</a></li><li><a href="global.html#atRuleToken">atRuleToken</a></li><li><a href="global.html">calculate</a></li><li><a href="global.html#charToken">charToken</a></li><li><a href="global.html#clearRules">clearRules</a></li><li><a href="global.html#commentToken">commentToken</a></li><li><a href="global.html#compare">compare</a></li><li><a href="global.html#comparisonToken">comparisonToken</a></li><li><a href="global.html#count">count</a></li><li><a href="global.html#createToken">createToken</a></li><li><a href="global.html">createTokenData</a></li><li><a href="global.html#drop">drop</a></li><li><a href="global.html#endFormat">endFormat</a></li><li><a href="global.html#eof">eof</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#fire">fire</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#formatResults">formatResults</a></li><li><a href="global.html">fromToken</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#getCol">getCol</a></li><li><a href="global.html#getEmbeddedRuleset">getEmbeddedRuleset</a></li><li><a href="global.html#getFormatter">getFormatter</a></li><li><a href="global.html#getLine">getLine</a></li><li><a href="global.html#getRules">getRules</a></li><li><a href="global.html#getRuleset">getRuleset</a></li><li><a href="global.html#hasFormat">hasFormat</a></li><li><a href="global.html#hashToken">hashToken</a></li><li><a href="global.html#hasNext">hasNext</a></li><li><a href="global.html#htmlCommentEndToken">htmlCommentEndToken</a></li><li><a href="global.html#htmlCommentStartToken">htmlCommentStartToken</a></li><li><a href="global.html#identOrFunctionToken">identOrFunctionToken</a></li><li><a href="global.html#importantToken">importantToken</a></li><li><a href="global.html#info">info</a></li><li><a href="global.html#isAny">isAny</a></li><li><a href="global.html#isAnyOfGroup">isAnyOfGroup</a></li><li><a href="global.html#isFirst">isFirst</a></li><li><a href="global.html#isType">isType</a></li><li><a href="global.html#LA">LA</a></li><li><a href="global.html#mark">mark</a></li><li><a href="global.html#match">match</a></li><li><a href="global.html#mustMatch">mustMatch</a></li><li><a href="global.html#next">next</a></li><li><a href="global.html#notToken">notToken</a></li><li><a href="global.html#numberToken">numberToken</a></li><li><a href="global.html#parserPropertyValue">parserPropertyValue</a></li><li><a href="global.html#parseRule">parseRule</a></li><li><a href="global.html#parseSelector">parseSelector</a></li><li><a href="global.html#parseStyleAttribute">parseStyleAttribute</a></li><li><a href="global.html#peek">peek</a></li><li><a href="global.html#previous">previous</a></li><li><a href="global.html#read">read</a></li><li><a href="global.html#readCount">readCount</a></li><li><a href="global.html#readError">readError</a></li><li><a href="global.html#readMatch">readMatch</a></li><li><a href="global.html#readTo">readTo</a></li><li><a href="global.html#readWhile">readWhile</a></li><li><a href="global.html#removeListener">removeListener</a></li><li><a href="global.html#report">report</a></li><li><a href="global.html#restore">restore</a></li><li><a href="global.html#rollupError">rollupError</a></li><li><a href="global.html#rollupWarn">rollupWarn</a></li><li><a href="global.html#startFormat">startFormat</a></li><li><a href="global.html#stat">stat</a></li><li><a href="global.html#stringToken">stringToken</a></li><li><a href="global.html#SVGReader">SVGReader</a></li><li><a href="global.html#token">token</a></li><li><a href="global.html#tokenName">tokenName</a></li><li><a href="global.html#toString">toString</a></li><li><a href="global.html#unget">unget</a></li><li><a href="global.html#valueOf">valueOf</a></li><li><a href="global.html#verify">verify</a></li><li><a href="global.html#warn">warn</a></li><li><a href="global.html#whitespaceToken">whitespaceToken</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/codemirror/mode/pug/pug.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE

(function(mod) {
  if (typeof exports == "object" &amp;&amp; typeof module == "object") // CommonJS
    mod(require("../../lib/codemirror"), require("../javascript/javascript"), require("../css/css"), require("../htmlmixed/htmlmixed"));
  else if (typeof define == "function" &amp;&amp; define.amd) // AMD
    define(["../../lib/codemirror", "../javascript/javascript", "../css/css", "../htmlmixed/htmlmixed"], mod);
  else // Plain browser env
    mod(CodeMirror);
})(function(CodeMirror) {
"use strict";

CodeMirror.defineMode("pug", function (config) {
  // token types
  var KEYWORD = 'keyword';
  var DOCTYPE = 'meta';
  var ID = 'builtin';
  var CLASS = 'qualifier';

  var ATTRS_NEST = {
    '{': '}',
    '(': ')',
    '[': ']'
  };

  var jsMode = CodeMirror.getMode(config, 'javascript');

  function State() {
    this.javaScriptLine = false;
    this.javaScriptLineExcludesColon = false;

    this.javaScriptArguments = false;
    this.javaScriptArgumentsDepth = 0;

    this.isInterpolating = false;
    this.interpolationNesting = 0;

    this.jsState = CodeMirror.startState(jsMode);

    this.restOfLine = '';

    this.isIncludeFiltered = false;
    this.isEach = false;

    this.lastTag = '';
    this.scriptType = '';

    // Attributes Mode
    this.isAttrs = false;
    this.attrsNest = [];
    this.inAttributeName = true;
    this.attributeIsType = false;
    this.attrValue = '';

    // Indented Mode
    this.indentOf = Infinity;
    this.indentToken = '';

    this.innerMode = null;
    this.innerState = null;

    this.innerModeForLine = false;
  }
  /**
   * Safely copy a state
   *
   * @return {State}
   */
  State.prototype.copy = function () {
    var res = new State();
    res.javaScriptLine = this.javaScriptLine;
    res.javaScriptLineExcludesColon = this.javaScriptLineExcludesColon;
    res.javaScriptArguments = this.javaScriptArguments;
    res.javaScriptArgumentsDepth = this.javaScriptArgumentsDepth;
    res.isInterpolating = this.isInterpolating;
    res.interpolationNesting = this.interpolationNesting;

    res.jsState = CodeMirror.copyState(jsMode, this.jsState);

    res.innerMode = this.innerMode;
    if (this.innerMode &amp;&amp; this.innerState) {
      res.innerState = CodeMirror.copyState(this.innerMode, this.innerState);
    }

    res.restOfLine = this.restOfLine;

    res.isIncludeFiltered = this.isIncludeFiltered;
    res.isEach = this.isEach;
    res.lastTag = this.lastTag;
    res.scriptType = this.scriptType;
    res.isAttrs = this.isAttrs;
    res.attrsNest = this.attrsNest.slice();
    res.inAttributeName = this.inAttributeName;
    res.attributeIsType = this.attributeIsType;
    res.attrValue = this.attrValue;
    res.indentOf = this.indentOf;
    res.indentToken = this.indentToken;

    res.innerModeForLine = this.innerModeForLine;

    return res;
  };

  function javaScript(stream, state) {
    if (stream.sol()) {
      // if javaScriptLine was set at end of line, ignore it
      state.javaScriptLine = false;
      state.javaScriptLineExcludesColon = false;
    }
    if (state.javaScriptLine) {
      if (state.javaScriptLineExcludesColon &amp;&amp; stream.peek() === ':') {
        state.javaScriptLine = false;
        state.javaScriptLineExcludesColon = false;
        return;
      }
      var tok = jsMode.token(stream, state.jsState);
      if (stream.eol()) state.javaScriptLine = false;
      return tok || true;
    }
  }
  function javaScriptArguments(stream, state) {
    if (state.javaScriptArguments) {
      if (state.javaScriptArgumentsDepth === 0 &amp;&amp; stream.peek() !== '(') {
        state.javaScriptArguments = false;
        return;
      }
      if (stream.peek() === '(') {
        state.javaScriptArgumentsDepth++;
      } else if (stream.peek() === ')') {
        state.javaScriptArgumentsDepth--;
      }
      if (state.javaScriptArgumentsDepth === 0) {
        state.javaScriptArguments = false;
        return;
      }

      var tok = jsMode.token(stream, state.jsState);
      return tok || true;
    }
  }

  function yieldStatement(stream) {
    if (stream.match(/^yield\b/)) {
        return 'keyword';
    }
  }

  function doctype(stream) {
    if (stream.match(/^(?:doctype) *([^\n]+)?/)) {
        return DOCTYPE;
    }
  }

  function interpolation(stream, state) {
    if (stream.match('#{')) {
      state.isInterpolating = true;
      state.interpolationNesting = 0;
      return 'punctuation';
    }
  }

  function interpolationContinued(stream, state) {
    if (state.isInterpolating) {
      if (stream.peek() === '}') {
        state.interpolationNesting--;
        if (state.interpolationNesting &lt; 0) {
          stream.next();
          state.isInterpolating = false;
          return 'punctuation';
        }
      } else if (stream.peek() === '{') {
        state.interpolationNesting++;
      }
      return jsMode.token(stream, state.jsState) || true;
    }
  }

  function caseStatement(stream, state) {
    if (stream.match(/^case\b/)) {
      state.javaScriptLine = true;
      return KEYWORD;
    }
  }

  function when(stream, state) {
    if (stream.match(/^when\b/)) {
      state.javaScriptLine = true;
      state.javaScriptLineExcludesColon = true;
      return KEYWORD;
    }
  }

  function defaultStatement(stream) {
    if (stream.match(/^default\b/)) {
      return KEYWORD;
    }
  }

  function extendsStatement(stream, state) {
    if (stream.match(/^extends?\b/)) {
      state.restOfLine = 'string';
      return KEYWORD;
    }
  }

  function append(stream, state) {
    if (stream.match(/^append\b/)) {
      state.restOfLine = 'variable';
      return KEYWORD;
    }
  }
  function prepend(stream, state) {
    if (stream.match(/^prepend\b/)) {
      state.restOfLine = 'variable';
      return KEYWORD;
    }
  }
  function block(stream, state) {
    if (stream.match(/^block\b *(?:(prepend|append)\b)?/)) {
      state.restOfLine = 'variable';
      return KEYWORD;
    }
  }

  function include(stream, state) {
    if (stream.match(/^include\b/)) {
      state.restOfLine = 'string';
      return KEYWORD;
    }
  }

  function includeFiltered(stream, state) {
    if (stream.match(/^include:([a-zA-Z0-9\-]+)/, false) &amp;&amp; stream.match('include')) {
      state.isIncludeFiltered = true;
      return KEYWORD;
    }
  }

  function includeFilteredContinued(stream, state) {
    if (state.isIncludeFiltered) {
      var tok = filter(stream, state);
      state.isIncludeFiltered = false;
      state.restOfLine = 'string';
      return tok;
    }
  }

  function mixin(stream, state) {
    if (stream.match(/^mixin\b/)) {
      state.javaScriptLine = true;
      return KEYWORD;
    }
  }

  function call(stream, state) {
    if (stream.match(/^\+([-\w]+)/)) {
      if (!stream.match(/^\( *[-\w]+ *=/, false)) {
        state.javaScriptArguments = true;
        state.javaScriptArgumentsDepth = 0;
      }
      return 'variable';
    }
    if (stream.match(/^\+#{/, false)) {
      stream.next();
      state.mixinCallAfter = true;
      return interpolation(stream, state);
    }
  }
  function callArguments(stream, state) {
    if (state.mixinCallAfter) {
      state.mixinCallAfter = false;
      if (!stream.match(/^\( *[-\w]+ *=/, false)) {
        state.javaScriptArguments = true;
        state.javaScriptArgumentsDepth = 0;
      }
      return true;
    }
  }

  function conditional(stream, state) {
    if (stream.match(/^(if|unless|else if|else)\b/)) {
      state.javaScriptLine = true;
      return KEYWORD;
    }
  }

  function each(stream, state) {
    if (stream.match(/^(- *)?(each|for)\b/)) {
      state.isEach = true;
      return KEYWORD;
    }
  }
  function eachContinued(stream, state) {
    if (state.isEach) {
      if (stream.match(/^ in\b/)) {
        state.javaScriptLine = true;
        state.isEach = false;
        return KEYWORD;
      } else if (stream.sol() || stream.eol()) {
        state.isEach = false;
      } else if (stream.next()) {
        while (!stream.match(/^ in\b/, false) &amp;&amp; stream.next());
        return 'variable';
      }
    }
  }

  function whileStatement(stream, state) {
    if (stream.match(/^while\b/)) {
      state.javaScriptLine = true;
      return KEYWORD;
    }
  }

  function tag(stream, state) {
    var captures;
    if (captures = stream.match(/^(\w(?:[-:\w]*\w)?)\/?/)) {
      state.lastTag = captures[1].toLowerCase();
      if (state.lastTag === 'script') {
        state.scriptType = 'application/javascript';
      }
      return 'tag';
    }
  }

  function filter(stream, state) {
    if (stream.match(/^:([\w\-]+)/)) {
      var innerMode;
      if (config &amp;&amp; config.innerModes) {
        innerMode = config.innerModes(stream.current().substring(1));
      }
      if (!innerMode) {
        innerMode = stream.current().substring(1);
      }
      if (typeof innerMode === 'string') {
        innerMode = CodeMirror.getMode(config, innerMode);
      }
      setInnerMode(stream, state, innerMode);
      return 'atom';
    }
  }

  function code(stream, state) {
    if (stream.match(/^(!?=|-)/)) {
      state.javaScriptLine = true;
      return 'punctuation';
    }
  }

  function id(stream) {
    if (stream.match(/^#([\w-]+)/)) {
      return ID;
    }
  }

  function className(stream) {
    if (stream.match(/^\.([\w-]+)/)) {
      return CLASS;
    }
  }

  function attrs(stream, state) {
    if (stream.peek() == '(') {
      stream.next();
      state.isAttrs = true;
      state.attrsNest = [];
      state.inAttributeName = true;
      state.attrValue = '';
      state.attributeIsType = false;
      return 'punctuation';
    }
  }

  function attrsContinued(stream, state) {
    if (state.isAttrs) {
      if (ATTRS_NEST[stream.peek()]) {
        state.attrsNest.push(ATTRS_NEST[stream.peek()]);
      }
      if (state.attrsNest[state.attrsNest.length - 1] === stream.peek()) {
        state.attrsNest.pop();
      } else  if (stream.eat(')')) {
        state.isAttrs = false;
        return 'punctuation';
      }
      if (state.inAttributeName &amp;&amp; stream.match(/^[^=,\)!]+/)) {
        if (stream.peek() === '=' || stream.peek() === '!') {
          state.inAttributeName = false;
          state.jsState = CodeMirror.startState(jsMode);
          if (state.lastTag === 'script' &amp;&amp; stream.current().trim().toLowerCase() === 'type') {
            state.attributeIsType = true;
          } else {
            state.attributeIsType = false;
          }
        }
        return 'attribute';
      }

      var tok = jsMode.token(stream, state.jsState);
      if (state.attributeIsType &amp;&amp; tok === 'string') {
        state.scriptType = stream.current().toString();
      }
      if (state.attrsNest.length === 0 &amp;&amp; (tok === 'string' || tok === 'variable' || tok === 'keyword')) {
        try {
          Function('', 'var x ' + state.attrValue.replace(/,\s*$/, '').replace(/^!/, ''));
          state.inAttributeName = true;
          state.attrValue = '';
          stream.backUp(stream.current().length);
          return attrsContinued(stream, state);
        } catch (ex) {
          //not the end of an attribute
        }
      }
      state.attrValue += stream.current();
      return tok || true;
    }
  }

  function attributesBlock(stream, state) {
    if (stream.match(/^&amp;attributes\b/)) {
      state.javaScriptArguments = true;
      state.javaScriptArgumentsDepth = 0;
      return 'keyword';
    }
  }

  function indent(stream) {
    if (stream.sol() &amp;&amp; stream.eatSpace()) {
      return 'indent';
    }
  }

  function comment(stream, state) {
    if (stream.match(/^ *\/\/(-)?([^\n]*)/)) {
      state.indentOf = stream.indentation();
      state.indentToken = 'comment';
      return 'comment';
    }
  }

  function colon(stream) {
    if (stream.match(/^: */)) {
      return 'colon';
    }
  }

  function text(stream, state) {
    if (stream.match(/^(?:\| ?| )([^\n]+)/)) {
      return 'string';
    }
    if (stream.match(/^(&lt;[^\n]*)/, false)) {
      // html string
      setInnerMode(stream, state, 'htmlmixed');
      state.innerModeForLine = true;
      return innerMode(stream, state, true);
    }
  }

  function dot(stream, state) {
    if (stream.eat('.')) {
      var innerMode = null;
      if (state.lastTag === 'script' &amp;&amp; state.scriptType.toLowerCase().indexOf('javascript') != -1) {
        innerMode = state.scriptType.toLowerCase().replace(/"|'/g, '');
      } else if (state.lastTag === 'style') {
        innerMode = 'css';
      }
      setInnerMode(stream, state, innerMode);
      return 'dot';
    }
  }

  function fail(stream) {
    stream.next();
    return null;
  }


  function setInnerMode(stream, state, mode) {
    mode = CodeMirror.mimeModes[mode] || mode;
    mode = config.innerModes ? config.innerModes(mode) || mode : mode;
    mode = CodeMirror.mimeModes[mode] || mode;
    mode = CodeMirror.getMode(config, mode);
    state.indentOf = stream.indentation();

    if (mode &amp;&amp; mode.name !== 'null') {
      state.innerMode = mode;
    } else {
      state.indentToken = 'string';
    }
  }
  function innerMode(stream, state, force) {
    if (stream.indentation() > state.indentOf || (state.innerModeForLine &amp;&amp; !stream.sol()) || force) {
      if (state.innerMode) {
        if (!state.innerState) {
          state.innerState = state.innerMode.startState ? CodeMirror.startState(state.innerMode, stream.indentation()) : {};
        }
        return stream.hideFirstChars(state.indentOf + 2, function () {
          return state.innerMode.token(stream, state.innerState) || true;
        });
      } else {
        stream.skipToEnd();
        return state.indentToken;
      }
    } else if (stream.sol()) {
      state.indentOf = Infinity;
      state.indentToken = null;
      state.innerMode = null;
      state.innerState = null;
    }
  }
  function restOfLine(stream, state) {
    if (stream.sol()) {
      // if restOfLine was set at end of line, ignore it
      state.restOfLine = '';
    }
    if (state.restOfLine) {
      stream.skipToEnd();
      var tok = state.restOfLine;
      state.restOfLine = '';
      return tok;
    }
  }


  function startState() {
    return new State();
  }
  function copyState(state) {
    return state.copy();
  }
  /**
   * Get the next token in the stream
   *
   * @param {Stream} stream
   * @param {State} state
   */
  function nextToken(stream, state) {
    var tok = innerMode(stream, state)
      || restOfLine(stream, state)
      || interpolationContinued(stream, state)
      || includeFilteredContinued(stream, state)
      || eachContinued(stream, state)
      || attrsContinued(stream, state)
      || javaScript(stream, state)
      || javaScriptArguments(stream, state)
      || callArguments(stream, state)

      || yieldStatement(stream, state)
      || doctype(stream, state)
      || interpolation(stream, state)
      || caseStatement(stream, state)
      || when(stream, state)
      || defaultStatement(stream, state)
      || extendsStatement(stream, state)
      || append(stream, state)
      || prepend(stream, state)
      || block(stream, state)
      || include(stream, state)
      || includeFiltered(stream, state)
      || mixin(stream, state)
      || call(stream, state)
      || conditional(stream, state)
      || each(stream, state)
      || whileStatement(stream, state)
      || tag(stream, state)
      || filter(stream, state)
      || code(stream, state)
      || id(stream, state)
      || className(stream, state)
      || attrs(stream, state)
      || attributesBlock(stream, state)
      || indent(stream, state)
      || text(stream, state)
      || comment(stream, state)
      || colon(stream, state)
      || dot(stream, state)
      || fail(stream, state);

    return tok === true ? null : tok;
  }
  return {
    startState: startState,
    copyState: copyState,
    token: nextToken
  };
}, 'javascript', 'css', 'htmlmixed');

CodeMirror.defineMIME('text/x-pug', 'pug');
CodeMirror.defineMIME('text/x-jade', 'pug');

});
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Dec 31 2018 11:58:32 GMT+0000 (GMT Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/jquery-3.1.1.min.js"></script>

<script src="scripts/search.js"></script>


<script src="scripts/collapse.js"></script>



</body>
</html>
